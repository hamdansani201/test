<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Mutabaah System</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --bg: #0d1117; --card: #161b22; --text: #c9d1d9; --primary: #2ecc71; --blue: #3498db; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; display: flex; justify-content: center; min-height: 100vh; }
        .container { width: 100%; max-width: 450px; padding: 20px; box-sizing: border-box; }
        
        /* Skrin Management */
        #page-1, #page-2, #page-3 { display: none; width: 100%; animation: fadeIn 0.5s; }
        .active { display: block !important; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* UI Elements */
        .card { background: var(--card); border: 1px solid #30363d; border-radius: 15px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        button { width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 16px; transition: 0.3s; }
        input[type="text"], input[type="date"] { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #30363d; background: #0d1117; color: white; box-sizing: border-box; margin-bottom: 15px; }
        
        /* Mutabaah Specific */
        .grid-solat { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left; margin-bottom: 20px; }
        .checkbox-item { background: #0d1117; padding: 10px; border-radius: 8px; border: 1px solid #30363d; display: flex; align-items: center; }
        .checkbox-item input { margin-right: 10px; transform: scale(1.2); }
        .stats { background: #0d1117; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid var(--primary); display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

    <div class="container">
        
        <div id="page-1" class="card">
            <h1 style="color: var(--blue);">üì≤ Langkah 1</h1>
            <p>Pasang aplikasi ke telefon anda untuk hilangkan bar alamat browser dan nampak lebih kemas.</p>
            <button id="btnInstall" style="background: var(--blue); color: white;">PASANG APLIKASI</button>
            <button onclick="tukarSkrin('page-2')" style="background: none; color: var(--text); font-size: 14px; text-decoration: underline;">Nanti dulu, teruskan ke Daftar</button>
        </div>

        <div id="page-2" class="card">
            <h1 style="color: var(--primary);">üìù Langkah 2</h1>
            <p>Masukkan nama anda untuk mula merekod Mutabaah Ramadan 1447H.</p>
            <input type="text" id="input-nama" placeholder="Contoh: Hamdan Sani">
            <button onclick="prosesDaftar()" style="background: var(--primary); color: white;">MULA REKOD AMALAN</button>
        </div>

        <div id="page-3">
            <div class="card">
                <h2 style="margin:0; color: var(--primary);">Ramadan 1447H</h2>
                <p style="margin: 5px 0 20px 0; font-size: 14px; opacity: 0.7;">Digital Mutabaah System</p>
                
                <div class="stats">
                    <div>
                        <span style="font-size: 12px; opacity: 0.7;">üë§ Pengguna</span><br>
                        <strong id="papar-nama" style="color: var(--blue);"></strong>
                    </div>
                    <div style="text-align: right;">
                        <span style="font-size: 12px; opacity: 0.7;">üíé Mata</span><br>
                        <strong style="color: #f1c40f;">150</strong>
                    </div>
                </div>

                <div style="text-align: left;">
                    <label style="font-size: 14px;">üìÖ Pilih Tarikh:</label>
                    <input type="date" id="tarikh-amalan">

                    <h4 style="border-left: 4px solid var(--primary); padding-left: 10px; margin: 20px 0 10px 0;">SOLAT FARDHU</h4>
                    <div class="grid-solat">
                        <div class="checkbox-item"><input type="checkbox"> Subuh</div>
                        <div class="checkbox-item"><input type="checkbox"> Zuhur</div>
                        <div class="checkbox-item"><input type="checkbox"> Asar</div>
                        <div class="checkbox-item"><input type="checkbox"> Maghrib</div>
                        <div class="checkbox-item"><input type="checkbox"> Isyak</div>
                    </div>

                    <h4 style="border-left: 4px solid var(--blue); padding-left: 10px; margin: 20px 0 10px 0;">AMALAN SUNAT</h4>
                    <div class="grid-solat">
                        <div class="checkbox-item"><input type="checkbox"> Tarawih</div>
                        <div class="checkbox-item"><input type="checkbox"> Tadarus</div>
                        <div class="checkbox-item"><input type="checkbox"> Sedekah</div>
                        <div class="checkbox-item"><input type="checkbox"> Dhuha</div>
                    </div>
                </div>

                <button style="background: var(--primary); color: white; margin-top: 20px;" onclick="alert('Rekod Berjaya Disimpan!')">SIMPAN AMALAN</button>
                
                <button onclick="logKeluar()" style="background:none; color: #f85149; font-size: 12px; margin-top: 20px;">Log Keluar / Tukar Nama</button>
            </div>
        </div>

    </div>

    <script>
        // --- LOGIK NAVIGASI ---
        function tukarSkrin(pageId) {
            document.getElementById('page-1').classList.remove('active');
            document.getElementById('page-2').classList.remove('active');
            document.getElementById('page-3').classList.remove('active');
            document.getElementById(pageId).classList.add('active');
        }

        // --- LOGIK DAFTAR ---
        function prosesDaftar() {
            const nama = document.getElementById('input-nama').value;
            if (nama === "") { alert("Sila masukkan nama!"); return; }
            localStorage.setItem('user_nama', nama);
            bukaAplikasi(nama);
        }

        function bukaAplikasi(nama) {
            document.getElementById('papar-nama').innerText = nama;
            tukarSkrin('page-3');
            // Set tarikh harini automatik
            document.getElementById('tarikh-amalan').valueAsDate = new Date();
        }

        function logKeluar() {
            if(confirm("Adakah anda mahu log keluar?")) {
                localStorage.removeItem('user_nama');
                location.reload();
            }
        }

        // --- LOGIK PWA (INSTALL) ---
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            tukarSkrin('page-1');
        });

        document.getElementById('btnInstall').addEventListener('click', (e) => {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') { tukarSkrin('page-2'); }
                deferredPrompt = null;
            });
        });

        // --- CHECK STATUS ON LOAD ---
        window.onload = function() {
            const namaLama = localStorage.getItem('user_nama');
            if (namaLama) {
                bukaAplikasi(namaLama);
            } else {
                tukarSkrin('page-2'); // Terus ke daftar jika PWA tak dpt dikesan
            }
        };

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
